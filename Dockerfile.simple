FROM python:3.11-slim
WORKDIR /app

# 필수 패키지만 설치
RUN pip install --upgrade pip
RUN pip install flask gunicorn

# 애플리케이션 파일 복사
COPY simple_server.py .
COPY templates/ templates/
COPY static/ static/
COPY data/ data/

# 포트 설정
ENV PORT=8080
EXPOSE 8080

# Gunicorn 실행
CMD exec gunicorn \
     --bind 0.0.0.0:$PORT \
     --workers 1 \
     --threads 8 \
     --timeout 0 \
     --log-level info \
     --access-logfile - \
     --error-logfile - \
     simple_server:app